import{d as I,r as _,c as y,o as B,f as H,a as u,b as t,e as L,t as o,F as N,g as P,h as T,_ as V,i as W,E as U,j as b,k as q,l as m,m as z}from"./index-BSLgM4mg.js";const G={class:"page-container"},$={key:0,class:"loading"},j={key:1,class:"error"},A={key:2},M={id:"summary-and-top5"},X={class:"summary-cards-grid"},Y={class:"summary-card",style:{"border-top-color":"var(--pastel-yellow)"}},J={class:"summary-value"},Q={class:"summary-card",style:{"border-top-color":"var(--pastel-green)"}},Z={class:"summary-value"},tt={class:"summary-card",style:{"border-top-color":"var(--pastel-blue)"}},at={class:"summary-value"},et={class:"summary-card",style:{"border-top-color":"var(--pastel-pink)"}},lt={class:"summary-value"},ot={class:"summary-card",style:{"border-top-color":"var(--pastel-yellow)"}},nt={class:"summary-value"},st={class:"ranking-card",style:{"margin-top":"20px"}},rt={class:"top5-table"},it=["href"],dt={id:"charts",style:{"margin-top":"30px"}},ct={class:"chart-container",style:{"margin-top":"20px"}},ut={class:"chart-container",style:{"margin-top":"20px"}},mt={class:"table-container",style:{"margin-top":"30px"}},gt=I({__name:"Campaign1View",setup(ht){const f=_(!0),h=_(null),n=_([]),g=a=>parseFloat(a.replace(/,|%/g,""))||0,D=a=>{const e=a.slice(0);n.value=e.map(l=>({no:parseInt(l[0]),kolName:l[1],follower:g(l[2]),platform:l[3],link:l[4],reach:g(l[5]),like:g(l[6]),comment:g(l[7]),share:g(l[8]),totalEngagement:g(l[9]),ctr:g(l[10])}))},k=y(()=>[...n.value].sort((a,e)=>e.totalEngagement-a.totalEngagement).slice(0,5)),x=["#b8e0d2","#d6eaff","#ffd6e0","#e8d6ff","#fff2d6","#d6f5e8"],F=y(()=>({labels:n.value.map(a=>a.kolName),datasets:[{label:"Total Engagement",backgroundColor:x,data:n.value.map(a=>a.totalEngagement)}]})),R=y(()=>({labels:n.value.map(a=>a.kolName),datasets:[{label:"CTR (%)",data:n.value.map(a=>a.ctr),borderColor:"#ff6384",backgroundColor:"#ffb1c1",tension:.1}]})),p=y(()=>({totalReach:n.value.reduce((a,e)=>a+e.reach,0),totalLike:n.value.reduce((a,e)=>a+e.like,0),totalComment:n.value.reduce((a,e)=>a+e.comment,0),totalShare:n.value.reduce((a,e)=>a+e.share,0),totalEngagement:n.value.reduce((a,e)=>a+e.totalEngagement,0)}));B(async()=>{try{f.value=!0;const a=await H("Campaign 1");a&&a.length>1?D(a):h.value="No data found."}catch{h.value="Failed to load data."}finally{f.value=!1}});const w=async()=>{try{const a=new U("l","mm","a4"),e=a.internal.pageSize.getWidth(),l=a.internal.pageSize.getHeight(),r=10,S=document.querySelector("#summary-and-top5");if(S){const i=(await b(S,{scale:3})).toDataURL("image/png"),d=a.getImageProperties(i),c=e-r*2,v=d.height*c/d.width;a.addImage(i,"PNG",r,r,c,v)}const E=document.querySelector(".chart-container:nth-of-type(1)");if(E){a.addPage();const i=(await b(E,{scale:3})).toDataURL("image/png"),d=a.getImageProperties(i),c=e-r*2,v=d.height*c/d.width;a.addImage(i,"PNG",r,r,c,v)}const C=document.querySelector(".chart-container:nth-of-type(2)");if(C){a.addPage();const i=(await b(C,{scale:3})).toDataURL("image/png"),d=a.getImageProperties(i),c=e-r*2,v=d.height*c/d.width;a.addImage(i,"PNG",r,r,c,v)}a.addPage();const K=[["No.","KOL Name","Followers","Platform","Reach","Likes","Comments","Shares","Total Engagement","CTR (%)"]],O=n.value.map(s=>[s.no,s.kolName,s.follower.toLocaleString(),s.platform,s.reach.toLocaleString(),s.like.toLocaleString(),s.comment.toLocaleString(),s.share.toLocaleString(),s.totalEngagement.toLocaleString(),s.ctr.toFixed(2)]);q(a,{head:K,body:O,startY:r,styles:{fontSize:7},headStyles:{fillColor:[100,100,255]},margin:{left:r,right:r},pageBreak:"auto"}),a.save("Full_KOL_Report.pdf")}catch(a){console.error("Export PDF failed:",a)}};return(a,e)=>(m(),u("div",G,[e[11]||(e[11]=t("h1",null,"UNBOX Details",-1)),t("div",{class:"export-button-wrapper"},[t("button",{onClick:w,class:"btn-export"},"Export Full Report PDF")]),f.value?(m(),u("div",$,"Loading Data...")):L("",!0),h.value?(m(),u("div",j,o(h.value),1)):L("",!0),!f.value&&!h.value?(m(),u("div",A,[t("div",M,[t("div",X,[t("div",Y,[e[0]||(e[0]=t("h3",null,"Total Engagement",-1)),t("p",J,o(p.value.totalEngagement.toLocaleString()),1)]),t("div",Q,[e[1]||(e[1]=t("h3",null,"Total Reach",-1)),t("p",Z,o(p.value.totalReach.toLocaleString()),1)]),t("div",tt,[e[2]||(e[2]=t("h3",null,"Total Likes",-1)),t("p",at,o(p.value.totalLike.toLocaleString()),1)]),t("div",et,[e[3]||(e[3]=t("h3",null,"Total Comments",-1)),t("p",lt,o(p.value.totalComment.toLocaleString()),1)]),t("div",ot,[e[4]||(e[4]=t("h3",null,"Total Shares",-1)),t("p",nt,o(p.value.totalShare.toLocaleString()),1)])]),t("div",st,[e[6]||(e[6]=t("h2",null,"Top 5 KOLs by Engagement",-1)),t("table",rt,[e[5]||(e[5]=t("thead",null,[t("tr",null,[t("th",null,"KOL Name"),t("th",null,"Follower"),t("th",null,"Link Post"),t("th",null,"Total Engagement"),t("th",null,"CTR%")])],-1)),t("tbody",null,[(m(!0),u(N,null,P(k.value,l=>(m(),u("tr",{key:l.no},[t("td",null,o(l.kolName),1),t("td",null,o(l.follower.toLocaleString()),1),t("td",null,[t("a",{href:l.link,target:"_blank",rel:"noopener noreferrer"},o(l.link),9,it)]),t("td",null,o(l.totalEngagement.toLocaleString()),1),t("td",null,o(l.ctr.toFixed(2))+"%",1)]))),128))])])])]),t("div",dt,[t("div",ct,[e[7]||(e[7]=t("h2",null,"Kols Engagement",-1)),T(V,{"chart-data":F.value},null,8,["chart-data"])]),t("div",ut,[e[8]||(e[8]=t("h2",null,"CTR (%) by KOL Type",-1)),T(W,{"chart-data":R.value},null,8,["chart-data"])])]),t("div",mt,[e[10]||(e[10]=t("h2",null,"KOLs Data",-1)),t("table",null,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"No."),t("th",null,"KOL Name"),t("th",null,"Followers"),t("th",null,"Platform"),t("th",null,"Reach"),t("th",null,"Likes"),t("th",null,"Comments"),t("th",null,"Shares"),t("th",null,"Total Engagement"),t("th",null,"CTR (%)")])],-1)),t("tbody",null,[(m(!0),u(N,null,P(n.value,l=>(m(),u("tr",{key:l.no},[t("td",null,o(l.no),1),t("td",null,o(l.kolName),1),t("td",null,o(l.follower.toLocaleString()),1),t("td",null,o(l.platform),1),t("td",null,o(l.reach.toLocaleString()),1),t("td",null,o(l.like.toLocaleString()),1),t("td",null,o(l.comment.toLocaleString()),1),t("td",null,o(l.share.toLocaleString()),1),t("td",null,o(l.totalEngagement.toLocaleString()),1),t("td",null,o(l.ctr.toFixed(2))+"%",1)]))),128))])])])])):L("",!0)]))}}),vt=z(gt,[["__scopeId","data-v-6a3e16d0"]]);export{vt as default};
