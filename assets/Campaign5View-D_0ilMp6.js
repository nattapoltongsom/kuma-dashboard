import{d as B,r as p,c as g,o as V,f as W,a as r,b as t,e as h,t as o,F as C,g as E,h as T,_ as q,i as z,E as G,j as N,k as H,l as u,m as U}from"./index-BfIPHrPB.js";const $={class:"page-container"},j={key:0,class:"loading"},A={key:1,class:"error"},M={key:2},Y={id:"summary-and-top5"},J={class:"summary-cards-grid"},Q={class:"summary-card",style:{"border-top-color":"var(--pastel-yellow)"}},X={class:"summary-value"},Z={class:"summary-card",style:{"border-top-color":"var(--pastel-green)"}},tt={class:"summary-value"},at={class:"summary-card",style:{"border-top-color":"var(--pastel-blue)"}},et={class:"summary-value"},lt={class:"summary-card",style:{"border-top-color":"var(--pastel-pink)"}},ot={class:"summary-value"},nt={class:"summary-card",style:{"border-top-color":"var(--pastel-yellow)"}},st={class:"summary-value"},rt={class:"ranking-card",style:{"margin-top":"20px"}},ut={class:"top5-table"},dt=["href"],it={id:"charts",style:{"margin-top":"30px"}},ct={class:"chart-container"},mt={class:"chart-container",style:{"margin-top":"20px"}},gt={class:"table-container",style:{"margin-top":"30px"}},pt=B({__name:"Campaign5View",setup(ht){const m=p(!0),i=p(null),n=p([]),d=e=>parseFloat(e.replace(/,|%/g,""))||0,k=e=>{const a=e.slice(0);n.value=a.map(l=>({no:parseInt(l[0]),kolName:l[1],follower:d(l[2]),platform:l[3],link:l[4],reach:d(l[5]),like:d(l[6]),comment:d(l[7]),share:d(l[8]),totalEngagement:d(l[9]),ctr:d(l[10])}))},F=g(()=>[...n.value].sort((e,a)=>a.totalEngagement-e.totalEngagement).slice(0,5)),P=["#b8e0d2","#d6eaff","#ffd6e0","#e8d6ff","#fff2d6","#d6f5e8"],x=g(()=>({labels:n.value.map(e=>e.kolName),datasets:[{label:"Total Engagement",backgroundColor:P,data:n.value.map(e=>e.totalEngagement)}]})),D=g(()=>({labels:n.value.map(e=>e.kolName),datasets:[{label:"CTR (%)",data:n.value.map(e=>e.ctr),borderColor:"#ff6384",backgroundColor:"#ffb1c1",tension:.1}]})),c=g(()=>({totalReach:n.value.reduce((e,a)=>e+a.reach,0),totalLike:n.value.reduce((e,a)=>e+a.like,0),totalComment:n.value.reduce((e,a)=>e+a.comment,0),totalShare:n.value.reduce((e,a)=>e+a.share,0),totalEngagement:n.value.reduce((e,a)=>e+a.totalEngagement,0)}));V(async()=>{try{m.value=!0;const e=await W("Campaign 5");e&&e.length>1?k(e):i.value="No data found."}catch{i.value="Failed to load data."}finally{m.value=!1}});const R=async()=>{try{const e=new G("p","mm","a4"),a=e.internal.pageSize.getWidth(),l=document.querySelector("#summary-and-top5");if(!l){alert("ไม่พบส่วน summary และ top 5");return}const v=(await N(l,{scale:2})).toDataURL("image/png"),y=e.getImageProperties(v),f=a-10,K=y.height*f/y.width;e.addImage(v,"PNG",5,5,f,K);const _=document.querySelector("#charts");if(!_){alert("ไม่พบส่วนกราฟ");return}e.addPage();const L=(await N(_,{scale:2})).toDataURL("image/png"),S=e.getImageProperties(L),b=a-10,w=S.height*b/S.width;e.addImage(L,"PNG",5,5,b,w),e.addPage();const O=[["No.","KOL Name","Followers","Platform","Reach","Likes","Comments","Shares","Total Engagement","CTR (%)"]],I=n.value.map(s=>[s.no,s.kolName,s.follower.toLocaleString(),s.platform,s.reach.toLocaleString(),s.like.toLocaleString(),s.comment.toLocaleString(),s.share.toLocaleString(),s.totalEngagement.toLocaleString(),s.ctr.toFixed(2)]);H(e,{head:O,body:I,startY:10,styles:{fontSize:7},headStyles:{fillColor:[100,100,255]},margin:{left:5,right:5},pageBreak:"auto"}),e.save("Full_KOL_Report.pdf")}catch(e){console.error("Export PDF failed:",e)}};return(e,a)=>(u(),r("div",$,[a[11]||(a[11]=t("h1",null,"Campaign 5 Details",-1)),t("div",{class:"export-button-wrapper"},[t("button",{onClick:R,class:"btn-export"},"Export Full Report PDF")]),m.value?(u(),r("div",j,"Loading Data...")):h("",!0),i.value?(u(),r("div",A,o(i.value),1)):h("",!0),!m.value&&!i.value?(u(),r("div",M,[t("div",Y,[t("div",J,[t("div",Q,[a[0]||(a[0]=t("h3",null,"Total Engagement",-1)),t("p",X,o(c.value.totalEngagement.toLocaleString()),1)]),t("div",Z,[a[1]||(a[1]=t("h3",null,"Total Reach",-1)),t("p",tt,o(c.value.totalReach.toLocaleString()),1)]),t("div",at,[a[2]||(a[2]=t("h3",null,"Total Likes",-1)),t("p",et,o(c.value.totalLike.toLocaleString()),1)]),t("div",lt,[a[3]||(a[3]=t("h3",null,"Total Comments",-1)),t("p",ot,o(c.value.totalComment.toLocaleString()),1)]),t("div",nt,[a[4]||(a[4]=t("h3",null,"Total Shares",-1)),t("p",st,o(c.value.totalShare.toLocaleString()),1)])]),t("div",rt,[a[6]||(a[6]=t("h2",null,"Top 5 KOLs by Engagement",-1)),t("table",ut,[a[5]||(a[5]=t("thead",null,[t("tr",null,[t("th",null,"KOL Name"),t("th",null,"Follower"),t("th",null,"Link Post"),t("th",null,"Total Engagement"),t("th",null,"CTR%")])],-1)),t("tbody",null,[(u(!0),r(C,null,E(F.value,l=>(u(),r("tr",{key:l.no},[t("td",null,o(l.kolName),1),t("td",null,o(l.follower.toLocaleString()),1),t("td",null,[t("a",{href:l.link,target:"_blank",rel:"noopener noreferrer"},o(l.link),9,dt)]),t("td",null,o(l.totalEngagement.toLocaleString()),1),t("td",null,o(l.ctr.toFixed(2))+"%",1)]))),128))])])])]),t("div",it,[t("div",ct,[a[7]||(a[7]=t("h2",null,"CTR (%) by KOL Type",-1)),T(q,{"chart-data":D.value},null,8,["chart-data"])]),t("div",mt,[a[8]||(a[8]=t("h2",null,"Kols Engagement",-1)),T(z,{"chart-data":x.value},null,8,["chart-data"])])]),t("div",gt,[a[10]||(a[10]=t("h2",null,"KOLs Data",-1)),t("table",null,[a[9]||(a[9]=t("thead",null,[t("tr",null,[t("th",null,"No."),t("th",null,"KOL Name"),t("th",null,"Followers"),t("th",null,"Platform"),t("th",null,"Reach"),t("th",null,"Likes"),t("th",null,"Comments"),t("th",null,"Shares"),t("th",null,"Total Engagement"),t("th",null,"CTR (%)")])],-1)),t("tbody",null,[(u(!0),r(C,null,E(n.value,l=>(u(),r("tr",{key:l.no},[t("td",null,o(l.no),1),t("td",null,o(l.kolName),1),t("td",null,o(l.follower.toLocaleString()),1),t("td",null,o(l.platform),1),t("td",null,o(l.reach.toLocaleString()),1),t("td",null,o(l.like.toLocaleString()),1),t("td",null,o(l.comment.toLocaleString()),1),t("td",null,o(l.share.toLocaleString()),1),t("td",null,o(l.totalEngagement.toLocaleString()),1),t("td",null,o(l.ctr.toFixed(2))+"%",1)]))),128))])])])])):h("",!0)]))}}),_t=U(pt,[["__scopeId","data-v-9b12508f"]]);export{_t as default};
