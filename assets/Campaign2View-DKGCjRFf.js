import{d as V,r as v,c as g,o as z,f as I,a as i,b as t,e as f,t as o,F as R,g as C,h as E,_ as $,i as H,j as d,k as W}from"./index-CQG3M_2t.js";import{h as A,E as M,a as j}from"./jspdf.plugin.autotable-BU_zNT40.js";const q={class:"page-container"},G={key:0,class:"loading"},U={key:1,class:"error"},Y={key:2},J={class:"grid-container top-rankings-grid"},Q={class:"ranking-card"},X={class:"top5-table"},Z=["href"],tt={class:"report-summary"},et={class:"grid-container charts-row"},at={class:"chart-container"},lt={class:"grid-container charts-row"},ot={class:"chart-container"},nt={class:"summary-cards-grid"},st={class:"summary-card",style:{"border-top-color":"var(--pastel-green)"}},rt={class:"summary-value"},it={class:"summary-card",style:{"border-top-color":"var(--pastel-blue)"}},dt={class:"summary-value"},ut={class:"summary-card",style:{"border-top-color":"var(--pastel-pink)"}},ct={class:"summary-value"},gt={class:"summary-card",style:{"border-top-color":"var(--pastel-yellow)"}},mt={class:"summary-value"},ht={class:"table-container"},pt={class:"pagination"},vt=["disabled"],ft=["disabled"],y=10,yt=V({__name:"Campaign2View",setup(_t){const h=v(!0),m=v(null),n=v([]),r=l=>parseFloat(l.replace(/,|%/g,""))||0,F=l=>{l[0];const e=l.slice(1);n.value=e.map(a=>({no:parseInt(a[0]),kolName:a[1],follower:r(a[2]),platform:a[3],link:a[4],reach:r(a[5]),like:r(a[6]),comment:r(a[7]),share:r(a[8]),ctr:r(a[9]),totalEngagement:r(a[10]),engagementRateByFollower:r(a[11]),engagementRateByReach:r(a[12])}))},N=g(()=>[...n.value].sort((l,e)=>e.totalEngagement-l.totalEngagement).slice(0,5)),x=["#b8e0d2","#d6eaff","#ffd6e0","#e8d6ff","#fff2d6","#d6f5e8"],T=g(()=>({labels:n.value.map(e=>e.kolName),datasets:[{label:"Total Engagement",backgroundColor:x,data:n.value.map(e=>e.totalEngagement)}]})),P=g(()=>{const l=n.value.map(a=>a.kolName),e=n.value.map(a=>a.ctr);return{labels:l,datasets:[{label:"CTR (%)",data:e,borderColor:"#ff6384",backgroundColor:"#ffb1c1",tension:.1}]}}),p=g(()=>({totalReach:n.value.reduce((l,e)=>l+e.reach,0),totalLike:n.value.reduce((l,e)=>l+e.like,0),totalComment:n.value.reduce((l,e)=>l+e.comment,0),totalShare:n.value.reduce((l,e)=>l+e.share,0)})),u=v(1),_=g(()=>Math.ceil(n.value.length/y)),k=g(()=>{const l=(u.value-1)*y;return n.value.slice(l,l+y)});z(async()=>{try{h.value=!0;const l=await I("Campaign 2");l&&l.length>1?F(l):m.value="No data found."}catch{m.value="Failed to load data."}finally{h.value=!1}});const D=async()=>{const l=document.querySelector(".report-summary");if(!l){alert("ไม่พบส่วนสรุปสำหรับ export");return}try{const a=(await A(l,{scale:2})).toDataURL("image/png"),c=new M("p","mm","a4"),K=c.internal.pageSize.getWidth(),bt=c.internal.pageSize.getHeight(),b=c.getImageProperties(a),L=K,S=b.height*L/b.width;c.addImage(a,"PNG",0,0,L,S);const w=[["No.","KOL Name","Followers","Platform","Reach","Likes","Comments","Shares","Total Engagement","CTR (%)","ER by Follower (%)","ER by Reach (%)"]],B=n.value.map(s=>[s.no,s.kolName,s.follower.toLocaleString(),s.platform,s.reach.toLocaleString(),s.like.toLocaleString(),s.comment.toLocaleString(),s.share.toLocaleString(),s.totalEngagement.toLocaleString(),s.ctr.toFixed(2),s.engagementRateByFollower.toFixed(2),s.engagementRateByReach.toFixed(2)]),O=S+10;j(c,{head:w,body:B,startY:O,styles:{fontSize:8},headStyles:{fillColor:[100,100,255]},margin:{left:5,right:5}}),c.save("Full_KOL_Report.pdf")}catch(e){console.error("Export PDF failed:",e)}};return(l,e)=>(d(),i("div",q,[e[12]||(e[12]=t("h1",null,"KATO Details",-1)),t("div",{class:"export-button-wrapper"},[t("button",{onClick:D,class:"btn-export"}," Export Full Report PDF ")]),h.value?(d(),i("div",G,"Loading Data...")):f("",!0),m.value?(d(),i("div",U,o(m.value),1)):f("",!0),!h.value&&!m.value?(d(),i("div",Y,[t("div",J,[t("div",Q,[e[3]||(e[3]=t("h2",null,"Top 5 KOLs by Engagement",-1)),t("table",X,[e[2]||(e[2]=t("thead",null,[t("tr",null,[t("th",null,"KOL Name"),t("th",null,"Follower"),t("th",null,"Link Post"),t("th",null,"Engagement")])],-1)),t("tbody",null,[(d(!0),i(R,null,C(N.value,a=>(d(),i("tr",{key:a.no},[t("td",null,o(a.kolName),1),t("td",null,o(a.follower.toLocaleString()),1),t("td",null,[t("a",{href:a.link,target:"_blank",rel:"noopener noreferrer"},o(a.link),9,Z)]),t("td",null,o(a.totalEngagement.toLocaleString()),1)]))),128))])])])]),t("div",tt,[t("div",et,[t("div",at,[e[4]||(e[4]=t("h2",null,"Kols Engagement",-1)),E($,{"chart-data":T.value},null,8,["chart-data"])])]),t("div",lt,[t("div",ot,[e[5]||(e[5]=t("h2",null,"Average CTR (%) by KOL Type",-1)),E(H,{"chart-data":P.value},null,8,["chart-data"])])]),t("div",nt,[t("div",st,[e[6]||(e[6]=t("h3",null,"Total Reach",-1)),t("p",rt,o(p.value.totalReach.toLocaleString()),1)]),t("div",it,[e[7]||(e[7]=t("h3",null,"Total Likes",-1)),t("p",dt,o(p.value.totalLike.toLocaleString()),1)]),t("div",ut,[e[8]||(e[8]=t("h3",null,"Total Comments",-1)),t("p",ct,o(p.value.totalComment.toLocaleString()),1)]),t("div",gt,[e[9]||(e[9]=t("h3",null,"Total Shares",-1)),t("p",mt,o(p.value.totalShare.toLocaleString()),1)])])]),t("div",ht,[e[11]||(e[11]=t("h2",null,"KOLs Data",-1)),t("table",null,[e[10]||(e[10]=t("thead",null,[t("tr",null,[t("th",null,"No."),t("th",null,"KOL Name"),t("th",null,"Followers"),t("th",null,"Platform"),t("th",null,"Reach"),t("th",null,"Likes"),t("th",null,"Comments"),t("th",null,"Shares"),t("th",null,"Total Engagement"),t("th",null,"CTR (%)"),t("th",null,"ER by Follower (%)"),t("th",null,"ER by Reach (%)")])],-1)),t("tbody",null,[(d(!0),i(R,null,C(k.value,a=>(d(),i("tr",{key:a.no},[t("td",null,o(a.no),1),t("td",null,o(a.kolName),1),t("td",null,o(a.follower.toLocaleString()),1),t("td",null,o(a.platform),1),t("td",null,o(a.reach.toLocaleString()),1),t("td",null,o(a.like.toLocaleString()),1),t("td",null,o(a.comment.toLocaleString()),1),t("td",null,o(a.share.toLocaleString()),1),t("td",null,o(a.totalEngagement.toLocaleString()),1),t("td",null,o(a.ctr.toFixed(2))+"%",1),t("td",null,o(a.engagementRateByFollower.toFixed(2))+"%",1),t("td",null,o(a.engagementRateByReach.toFixed(2))+"%",1)]))),128))])]),t("div",pt,[t("button",{onClick:e[0]||(e[0]=a=>u.value--),disabled:u.value===1},"Prev",8,vt),t("span",null,"Page "+o(u.value)+" of "+o(_.value),1),t("button",{onClick:e[1]||(e[1]=a=>u.value++),disabled:u.value===_.value},"Next",8,ft)])])])):f("",!0)]))}}),Rt=W(yt,[["__scopeId","data-v-95b92b79"]]);export{Rt as default};
